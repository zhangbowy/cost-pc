(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[18],{MTO9:function(e,t,a){"use strict";a.r(t);a("g9YV");var n,r,c,o,l=a("wCAj"),i=(a("y8nQ"),a("Vl3Y")),s=(a("+L6B"),a("2/Rp")),d=(a("qVdP"),a("jsC+")),u=(a("Pwec"),a("CtXQ")),p=(a("/zsF"),a("PArb")),m=(a("lUTK"),a("BvKs")),f=(a("5Dmo"),a("3S7+")),y=(a("+BJd"),a("mr32")),h=a("p0pE"),g=a.n(h),b=(a("miYZ"),a("tsqr")),E=a("2Taf"),v=a.n(E),k=a("vZ4D"),I=a.n(k),N=a("rlhR"),C=a.n(N),O=a("MhPg"),x=a.n(O),S=a("l4Ni"),w=a.n(S),j=a("ujKo"),R=a.n(j),V=(a("2qtc"),a("kLXV")),D=a("q1tI"),T=a.n(D),q=a("/MKj"),P=a("17x9"),K=a.n(P),_=a("TSYQ"),A=a.n(_),F=a("2g+w"),L=a("ydnR"),Q=a("e9Pg"),M=a.n(Q),B=a("KtMI"),Y=(a("7Kak"),a("9yH6")),J=(a("6UJt"),a("DFOY")),Z=a("jehZ"),z=a.n(Z),U=(a("5NDa"),a("5rEg")),G=a("d6i3"),W=a.n(G),X=a("1l/V"),H=a.n(X),$=(a("OaEy"),a("2fM7")),ee=a("z0WU"),te=a("B1kb");function ae(e){var t=ne();return function(){var a,n=R()(e);if(t){var r=R()(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return w()(this,a)}}function ne(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var re={costName:"\u540d\u79f0",parentId:"\u6240\u5c5e\u5206\u7ec4",attribute:"\u7c7b\u578b"},ce={add:"costCategory/add",edit:"costCategory/edit",copy:"costCategory/copy"},oe=$["a"].Option,le=(n=i["a"].create(),r=Object(q["c"])(function(e){var t=e.loading,a=e.session,n=e.costCategory;return{loading:t.effects["costCategory/add"]||t.effects["costCategory/edit"]||t.effects["costCategory/copy"]||!1,userInfo:a.userInfo,allList:n.allList}}),n(c=r((o=function(e){x()(a,e);var t=ae(a);function a(e){var n;return v()(this,a),n=t.call(this,e),n.onRest=function(){n.props.form.resetFields()},n.handleOk=function(e){e.preventDefault();var t=n.props,a=t.dispatch,r=t.form,c=t.onOk,o=t.data,l=t.userInfo,i=t.title;r.validateFieldsAndScroll(function(e,t){if(!e){var r=g()({},t,{companyId:l.companyId||"",type:0});t.parentId&&"string"!==typeof t.parentId?Object.assign(r,{parentId:t.parentId&&t.parentId[t.parentId.length-1]}):Object.assign(r,{parentId:0}),"add"!==i&&Object.assign(r,{id:o.id}),"copy"===i&&Object.assign(r,{isGroup:1}),a({type:ce[i],payload:r}).then(function(){b["a"].success("".concat(L["u"][i],"\u6210\u529f")),n.setState({visible:!1}),n.onRest(),c()})}})},n.onShow=H()(W.a.mark(function e(){var t,a,r,c,o,l,i;return W.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,n.props.dispatch({type:"costCategory/allList",payload:{}});case 2:t=n.props,a=t.data,r=t.title,c=t.allList,o=c&&c.filter(function(e){return 0===Number(e.type)})||[],l=Object(F["a"])({rootId:0,pId:"parentId",tName:"costName",name:"costName",otherKeys:["icon","note","type","parentId","attribute"]},o),i=g()({},a),a&&a.parentId&&a&&"0"!==a.parentId&&(console.log(Object(ee["g"])(l,a.parentId,[])),Object.assign(i,{parentId:Object(ee["g"])(l,a.parentId,[])})),"copy"===r&&Object.assign(i,{costName:"".concat(a.costName,"\u7684\u526f\u672c")}),n.setState({visible:!0,data:i,lists:l});case 9:case"end":return e.stop()}},e)})),n.onCancel=function(){n.onRest(),n.setState({visible:!1})},n.state={visible:!1,data:{},lists:[]},n}return I()(a,[{key:"render",value:function(){var e=this,t=this.state,a=t.visible,n=t.data,r=t.lists,c=this.props,o=c.children,l=c.title,d=c.form.getFieldDecorator,u=te["a"].costType;return T.a.createElement("span",null,T.a.createElement("span",{onClick:function(){return e.onShow()}},o),T.a.createElement(V["a"],{title:l&&"".concat(L["u"][l],"\u5206\u7ec4"),visible:a,onCancel:this.onCancel,maskClosable:!1,footer:[T.a.createElement(s["a"],{key:"cancel",onClick:function(){return e.onCancel()}},"\u53d6\u6d88"),T.a.createElement(s["a"],{key:"save",type:"primary",onClick:function(t){return e.handleOk(t)}},"\u4fdd\u5b58")]},T.a.createElement(i["a"],{className:"formItem"},T.a.createElement(i["a"].Item,z()({key:"costName",label:re.costName},L["x"]),d("costName",{initialValue:n&&n.costName,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u540d\u79f0"}]})(T.a.createElement(U["a"],{placeholder:"\u8bf7\u8f93\u5165\u540d\u79f0"}))),"add"===l&&T.a.createElement(i["a"].Item,z()({key:"parentId",label:re.parentId},L["x"]),r&&0===r.length?d("parentId",{initialValue:n&&n.parentId||"0"})(T.a.createElement($["a"],{disabled:"edit"===l},T.a.createElement(oe,{key:"0"},"\u65e0"),r.map(function(e){return T.a.createElement(oe,{key:e.value},e.costName)}))):d("parentId",{initialValue:n&&n.parentId})(T.a.createElement(J["a"],{options:r,placeholder:"\u8bf7\u9009\u62e9",fieldNames:{label:"costName",value:"id"},disabled:"edit"===l,changeOnSelect:!0,getPopupContainer:function(e){return e.parentNode}}))),T.a.createElement(i["a"].Item,z()({label:"\u7c7b\u578b\u9009\u62e9"},L["x"]),d("attribute",{initialValue:n&&n.attribute||0})(T.a.createElement(Y["a"].Group,{disabled:"edit"===l||"copy"===l},u.map(function(e){return T.a.createElement(Y["a"],{key:e.key,value:e.key},e.value)})))))))}}]),a}(T.a.PureComponent),c=o))||c)||c),ie=le,se=a("qIgq"),de=a.n(se),ue=a("boNk"),pe=a.n(ue);function me(e){var t=Object(D["useState"])(e.visible),a=de()(t,2),n=a[0],r=a[1],c=function(t){e.linkInvoice(t),r(!1)};return T.a.createElement("span",null,T.a.createElement("span",{onClick:function(){return r(!0)}},e.children),T.a.createElement(V["a"],{title:null,footer:null,visible:n,onCancel:function(){return r(!1)},width:"520px",height:"400px"},T.a.createElement("p",{className:"fs-24 c-black-85 m-b-47",style:{marginLeft:"14px"}},"\u8bf7\u9009\u62e9\u4f60\u8981\u521b\u5efa\u7684\u652f\u51fa\u7c7b\u522b"),T.a.createElement("div",{className:pe.a.judgeType},T.a.createElement("div",{className:pe.a.cost,onClick:function(){return c("add_0")}},T.a.createElement("p",{className:"fs-20 c-black-85 m-l-24 m-b-10",style:{paddingTop:"45px"}},"\u8d39\u7528\u652f\u51fa"),T.a.createElement("p",{className:"c-black-36 fs-12 m-l-24"},"\xb7 \u6d89\u53ca\u5dee\u65c5\u3001\u56e2\u9910\u3001\u62db\u5f85\u3001\u51fa\u884c\u7b49")),T.a.createElement("div",{className:pe.a.chengben,onClick:function(){return c("add_1")}},T.a.createElement("p",{className:"fs-20 c-black-85 m-l-24 m-b-10",style:{paddingTop:"45px"}},"\u6210\u672c\u652f\u51fa"),T.a.createElement("p",{className:"c-black-36 fs-12 m-l-24"},"\xb7 \u6d89\u53ca\u4eba\u5de5\u3001\u623f\u79df\u6210\u672c\uff0c\u91c7\u8d2d\u3001\u7269\u6599\u3001\u56fa\u5b9a\u8d44\u4ea7\u6210\u672c\u7b49")))))}var fe,ye,he,ge,be=a("BZiS"),Ee=a("I0Kt");function ve(e){var t=ke();return function(){var a,n=R()(e);if(t){var r=R()(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return w()(this,a)}}function ke(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var Ie="costCategory",Ne=V["a"].confirm,Ce=(fe=Object(q["c"])(function(e){return{userInfo:e.session.userInfo,loading:e.loading.models[Ie],list:e[Ie].list,query:e[Ie].query}}),fe((ge=he=function(e){x()(a,e);var t=ve(a);function a(e){var n;return v()(this,a),n=t.call(this,e),n.onQuery=function(e){var t=n.props,a=t.userInfo,r=t.dispatch;Object.assign(e,{companyId:a.companyId||""}),r({type:"costCategory/costList",payload:e})},n.onOk=function(){var e=n.state.costName;n.onQuery({costName:e})},n.handleVisibleChange=function(e){var t=C()(n);n.props.dispatch({type:"costCategory/delPer",payload:{id:e}}).then(function(){Ne({title:"\u8bf7\u786e\u8ba4\u662f\u5426\u5220\u9664?",content:"\u5220\u9664\u4e0d\u80fd\u6062\u590d",okText:"\u786e\u8ba4",okType:"danger",cancelText:"\u53d6\u6d88",onOk:function(){t.onDelete(e)},onCancel:function(){console.log("Cancel")}})})},n.onAddCategory=function(e){n.props.history.push("/basicSetting/costCategory/".concat(e))},n.onSearch=function(e){n.setState({costName:e}),n.onQuery({costName:e})},n.onDelete=function(e){var t=n.props.userInfo;n.props.dispatch({type:"costCategory/del",payload:{id:e,companyId:t.companyId||""}}).then(function(){b["a"].success("\u5220\u9664\u6210\u529f"),n.onQuery({})})},n.changeVisible=function(){n.setState({typeVisible:!1})},n.getSort=function(e,t){var a=n.openTree(e,[]);n.props.dispatch({type:"costCategory/sort",payload:{sortList:a}}).then(function(){b["a"].success("\u6392\u5e8f\u6210\u529f!"),n.setState({costName:""},function(){n.onQuery({})}),t()})},n.openTree=function(e,t){for(var a=t,r=0;r<e.length;r++){var c=e[r];if(c.children&&c.children.length){var o=n.openTree(c.children,a);c.children="",a.concat(o)}a.push(c)}return a},n.sortData=function(e){for(var t=0;t<e.length;t++){var a=e[t];a.children&&a.children.length&&n.sortData(a.children)}e.sort(function(e,t){return e.sort-t.sort})},n.state={costName:"",typeVisible:!1},n}return I()(a,[{key:"componentDidMount",value:function(){this.onQuery({})}},{key:"render",value:function(){var e=this,t=this.props,a=t.list,n=t.loading,r=a.map(function(e){return g()({},e,{name:e.costName})}),c=this.state.typeVisible,o=Object(F["a"])({rootId:0,pId:"parentId",tName:"costName",name:"costName",otherKeys:["icon","note","type","parentId","status","attribute","sort"]},a);this.state.costName&&(o=a),this.sortData(o);var h=[{title:"\u540d\u79f0",dataIndex:"costName",ellipsis:!0,textWrap:"word-break",render:function(e,t){return T.a.createElement("span",null,T.a.createElement("span",{style:{marginRight:"8px"}},t.costName),0===t.status&&T.a.createElement(y["a"],{color:"red"},"\u5df2\u505c\u7528"),(0===t.type||0===t.parentId)&&0===Number(t.attribute)&&T.a.createElement(be["a"],{color:"rgba(0, 199, 149, 0.08)"},"\u8d39\u7528"),(0===t.type||0===t.parentId)&&1===t.attribute&&T.a.createElement(be["a"],{color:"#FFF1F0"},"\u6210\u672c"))}},{title:"\u56fe\u6807",dataIndex:"icon",render:function(e,t){return t.icon?T.a.createElement("i",{className:A()("iconfont","icon".concat(t.icon)),style:{color:Object(L["y"])(t.icon,L["m"]),fontSize:"30px"}}):T.a.createElement("span",null,"-")}},{title:"\u63cf\u8ff0",dataIndex:"note",width:360,render:function(e){return T.a.createElement("span",null,e&&e.length>48?T.a.createElement(f["a"],{placement:"top",title:e||""},T.a.createElement("span",{className:"eslips-2"},e)):T.a.createElement("span",{className:"eslips-2"},e))}},{title:"\u64cd\u4f5c",dataIndex:"operate",width:"160px",render:function(t,n){var r=e,c=[{node:T.a.createElement(ie,{onOk:function(){return r.onOk()},title:"add",data:{parentId:n.id},list:a},T.a.createElement("span",{className:"pd-20-9 c-black-65"},"\u6dfb\u52a0\u5b50\u5206\u7ec4"))},{node:T.a.createElement("span",{className:"m-l-8 pd-20-9 c-black-65",onClick:function(){return e.onAddCategory("child_".concat(n.id,"_").concat(n.attribute))}},"\u521b\u5efa\u5b50\u7c7b\u522b")},{node:T.a.createElement(ie,{data:g()({},n),title:"copy",list:a,onOk:function(){return r.onOk()}},T.a.createElement("span",{className:"m-l-8 pd-20-9 c-black-65"},"\u590d\u5236"))},{node:T.a.createElement("span",{className:"deleteColor m-l-8 pd-20-9",onClick:function(){return r.handleVisibleChange(n.id)}},"\u5220\u9664")}];1===n.type&&(c=[{node:T.a.createElement("span",{className:"pd-20-9 c-black-65",onClick:function(){return e.onAddCategory("copy_".concat(n.id,"_").concat(n.attribute))}},"\u590d\u5236")},{node:T.a.createElement("span",{onClick:function(){return r.handleVisibleChange(n.id)},className:"deleteColor pd-20-9"},"\u5220\u9664")}]);var o=T.a.createElement(m["a"],null,c.map(function(e,t){return T.a.createElement(m["a"].Item,{key:"q_".concat(t)},e.node)}));return T.a.createElement("span",null,0===n.type&&T.a.createElement(ie,{data:n,onOk:function(){return r.onOk()},title:"edit",list:a},T.a.createElement("a",null,"\u7f16\u8f91\u7ec4")),1===n.type&&T.a.createElement("a",{onClick:function(){return e.onAddCategory("edit_".concat(n.id,"_").concat(n.attribute))}},"\u7f16\u8f91\u7c7b\u522b"),T.a.createElement(p["a"],{type:"vertical"}),T.a.createElement(d["a"],{overlay:o},T.a.createElement("a",{className:"ant-dropdown-link m-l-8",onClick:function(e){return e.preventDefault()}},"\u66f4\u591a ",T.a.createElement(u["a"],{type:"down"}))))},className:"fixCenter"}];return T.a.createElement("div",{className:"mainContainer"},T.a.createElement(B["a"],{title:"\u652f\u51fa\u7c7b\u522b\u8bbe\u7f6e"}),T.a.createElement("div",{className:"content-dt "},T.a.createElement("div",{className:"cnt-header"},T.a.createElement("div",{className:"head_lf"},T.a.createElement(me,{title:"add",data:{},onOk:this.onOk,visible:c,changeVisible:this.changeVisible,linkInvoice:this.onAddCategory},T.a.createElement(s["a"],{type:"primary",style:{marginRight:"8px"}},"\u65b0\u589e\u652f\u51fa\u7c7b\u522b")),T.a.createElement(ie,{onOk:this.onOk,title:"add",list:a},T.a.createElement(s["a"],{style:{marginRight:"8px"}},"\u65b0\u589e\u5206\u7ec4")),T.a.createElement(i["a"],{style:{display:"inline-block"}},T.a.createElement(i["a"].Item,null,T.a.createElement(M.a,{placeholder:"\u8f93\u5165\u5173\u952e\u5b57\uff0c\u6309\u56de\u8f66\u641c\u7d22",style:{width:"272px"},onSearch:function(t){return e.onSearch(t)}})))),T.a.createElement("div",null,T.a.createElement(Ee["a"],{list:r,callback:this.getSort},T.a.createElement(s["a"],{type:"default"},"\u6392\u5e8f")))),T.a.createElement(l["a"],{rowKey:"id",loading:n,columns:h,dataSource:o,pagination:!1,defaultExpandAllRows:!0})))}}]),a}(T.a.PureComponent),he.propsTypes={list:K.a.array,query:K.a.object,loading:K.a.bool},ye=ge))||ye);t["default"]=Ce}}]);