(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[26],{"1dDB":function(e,t,a){"use strict";a.r(t);a("g9YV");var n,r,c,o,l=a("wCAj"),i=(a("+L6B"),a("2/Rp")),s=(a("/zsF"),a("PArb")),u=(a("5Dmo"),a("3S7+")),p=(a("+BJd"),a("mr32")),d=a("p0pE"),m=a.n(d),f=(a("miYZ"),a("tsqr")),h=a("2Taf"),y=a.n(h),v=a("vZ4D"),g=a.n(v),b=a("rlhR"),E=a.n(b),k=a("MhPg"),N=a.n(k),w=a("l4Ni"),C=a.n(w),I=a("ujKo"),S=a.n(I),R=(a("2qtc"),a("kLXV")),x=a("q1tI"),O=a.n(x),A=a("/MKj"),D=a("ydnR"),V=a("KtMI"),j=a("jehZ"),q=a.n(j),z=(a("sRBo"),a("kaz8")),B=(a("BoS7"),a("Sdc0")),P=(a("6UJt"),a("DFOY")),Q=(a("5NDa"),a("5rEg")),F=(a("y8nQ"),a("Vl3Y")),L=(a("OaEy"),a("2fM7")),J=a("27j4"),M=a.n(J),T=a("2g+w"),Y=a("z0WU");function K(e){var t=Z();return function(){var a,n=S()(e);if(t){var r=S()(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return C()(this,a)}}function Z(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var G,U,W,X={type:"\u8d26\u6237\u7c7b\u578b",name:"\u540d\u79f0",account:"\u94f6\u884c\u5361\u53f7",note:"\u5907\u6ce8",defaultStatus:"\u542f\u7528",status:"\u542f\u7528",bankNameBranch:"\u5f00\u6237\u652f\u884c",awAreas:"\u5f00\u6237\u7701\u5e02"},_=L["a"].Option,H=(n=F["a"].create(),r=Object(A["c"])(function(e){var t=e.loading,a=e.session,n=e.account,r=e.costGlobal;return{userInfo:a.userInfo,loading:t.effects["account/add"]||t.effects["account/edit"]||!1,detail:n.detail,areaCode:r.areaCode}}),n(c=r((o=function(e){N()(a,e);var t=K(a);function a(e){var n;return y()(this,a),n=t.call(this,e),n.onShow=function(){var e=n.props.record,t="0";n.props.dispatch({type:"costGlobal/area",payload:{}}).then(function(){var a=n.props.areaCode;console.log("AddAccount -> onShow -> areaCode",a);var r=Object(T["a"])({rootId:0,pId:"pid",name:"areaName",id:"areaCode",tName:"label",tId:"value"},a);e?(t=e.type,n.props.dispatch({type:"account/detail",payload:{id:e.id}}).then(function(){var e=n.props.detail;n.setState({visible:!0,type:t,data:m()({},e,{awAreas:e.awAreas?e.awAreas.sort(Object(Y["d"])("level")).map(function(e){return e.areaCode}):void 0}),treeList:r})})):n.setState({visible:!0,type:t,treeList:r})})},n.onRest=function(){n.props.form.resetFields(),n.setState({type:"0"})},n.handleOk=function(e){e.preventDefault();var t=n.props,a=t.dispatch,r=t.form,c=t.onOk,o=t.detail,l=t.userInfo,i=t.title,s=t.areaCode;r.validateFieldsAndScroll(function(e,t){if(!e){var r=m()({},t,{awAreas:t.awAreas?t.awAreas.map(function(e){var t=s.filter(function(t){return t.areaCode===e})[0];return m()({},t)}):[],companyId:l.companyId||"",type:Number(t.type),status:t.status?1:0}),u="account/add";"edit"===i&&(u="account/edit",Object.assign(r,{id:o.id})),a({type:u,payload:r}).then(function(){n.onRest(),f["a"].success("\u64cd\u4f5c\u6210\u529f"),n.setState({visible:!1}),c()})}})},n.onChange=function(e){n.setState({type:e})},n.check=function(e,t,a){t||0!==n.state.type?a():a("\u8bf7\u9009\u62e9\u5f00\u6237\u884c")},n.state={type:"0",visible:!1,treeList:[]},n}return g()(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.children,n=t.form.getFieldDecorator,r=t.title,c=this.state,o=c.type,l=c.visible,s=c.loading,u=c.data,p=c.treeList;return O.a.createElement("span",null,O.a.createElement("span",{onClick:function(){return e.onShow()}},a),O.a.createElement(R["a"],{title:r&&"".concat(D["u"][r],"\u4ed8\u6b3e\u8d26\u6237"),visible:l,bodyStyle:{height:"470px",overflowY:"scroll"},onCancel:function(){e.onRest(),e.setState({visible:!1})},maskClosable:!1,footer:[O.a.createElement(i["a"],{key:"cancel",onClick:function(){e.onRest(),e.setState({visible:!1})}},"\u53d6\u6d88"),O.a.createElement(i["a"],{key:"submit",type:"primary",onClick:this.handleOk,loading:s},"\u4fdd\u5b58")]},O.a.createElement(F["a"],q()({},D["x"],{className:"formItem"}),O.a.createElement(F["a"].Item,{label:X.type},n("type",{initialValue:Number(o)})(O.a.createElement(L["a"],{onChange:this.onChange},D["a"].map(function(e){return O.a.createElement(_,{key:e.key,value:e.key},e.value)})))),O.a.createElement(F["a"].Item,{label:X.name},n("name",{initialValue:u&&u.name,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u540d\u79f0"},{max:30,message:"\u4e0d\u8d85\u8fc730\u4e2a\u5b57"}]})(O.a.createElement(Q["a"],{placeholder:"\u8bf7\u8f93\u5165"}))),2!==Number(o)&&4!==Number(o)&&O.a.createElement(F["a"].Item,{label:0===Number(o)?X.account:"\u8d26\u53f7"},n("account",{initialValue:u&&u.account,rules:[{required:2!==Number(o)&&4!==Number(o),message:"\u8bf7\u8f93\u5165".concat(0===Number(o)?X.account:"\u8d26\u53f7")}]})(O.a.createElement(Q["a"],{placeholder:"\u8bf7\u8f93\u5165"}))),0===Number(o)&&O.a.createElement(F["a"].Item,{label:"\u5f00\u6237\u884c"},n("bankName",{initialValue:u&&u.bankName||void 0,rules:[{required:0===Number(o),message:"\u8bf7\u9009\u62e9\u5f00\u6237\u884c"}]})(O.a.createElement(L["a"],{showSearch:!0,placeholder:"\u8bf7\u9009\u62e9",getPopupContainer:function(e){return e.parentNode}},D["i"].map(function(e){return O.a.createElement(_,{key:e},e)})))),0===Number(o)&&O.a.createElement(F["a"].Item,{label:X.awAreas},n("awAreas",{initialValue:u&&u.awAreas||[]})(O.a.createElement(P["a"],{options:p,placeholder:"\u8bf7\u9009\u62e9".concat(X.awAreas),getPopupContainer:function(e){return e.parentNode}}))),0===Number(o)&&O.a.createElement(F["a"].Item,{label:X.bankNameBranch},n("bankNameBranch",{initialValue:u&&u.bankNameBranch})(O.a.createElement(Q["a"],{placeholder:"\u8bf7\u8f93\u5165".concat(X.bankNameBranch)}))),O.a.createElement(F["a"].Item,{label:X.note},n("note",{initialValue:u&&u.note})(O.a.createElement(M.a,{placeholder:"\u8bf7\u8f93\u5165"}))),O.a.createElement(F["a"].Item,{label:X.status},O.a.createElement("div",null,n("status",{initialValue:!(!u||1!==u.status),valuePropName:"checked"})(O.a.createElement(B["a"],null))),n("isDefault",{initialValue:u&&u.isDefault,valuePropName:"checked"})(O.a.createElement(z["a"],null,"\u8bbe\u4e3a\u9ed8\u8ba4"))))))}}]),a}(O.a.PureComponent),c=o))||c)||c),$=H;function ee(e){var t=te();return function(){var a,n=S()(e);if(t){var r=S()(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return C()(this,a)}}function te(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var ae=R["a"].confirm,ne=(G=Object(A["c"])(function(e){var t=e.loading,a=e.account,n=e.session;return{loading:t.effects["account/list"]||!1,list:a.list,query:a.query,userInfo:n.userInfo,total:a.total,check:a.check,signRes:a.signRes}}),G((W=function(e){N()(a,e);var t=ee(a);function a(e){var n;return y()(this,a),n=t.call(this,e),n.onQuery=function(e){var t=n.props.userInfo;Object.assign(e,{companyId:t.companyId||""}),n.props.dispatch({type:"account/list",payload:e})},n.onDelete=function(e){var t=n.props,a=t.userInfo,r=t.query;n.props.dispatch({type:"account/del",payload:{id:e,companyId:a.companyId||""}}).then(function(){f["a"].success("\u5220\u9664\u6210\u529f"),n.onQuery(m()({},r))})},n.handleVisibleChange=function(e){var t=E()(n);n.props.dispatch({type:"account/delPer",payload:{id:e}}).then(function(){n.props.check?ae({title:"\u8bf7\u786e\u8ba4\u662f\u5426\u5220\u9664?",content:"\u5220\u9664\u4e0d\u80fd\u6062\u590d",okText:"\u786e\u8ba4",okType:"danger",cancelText:"\u53d6\u6d88",onOk:function(){t.onDelete(e)},onCancel:function(){console.log("Cancel")}}):f["a"].error("\u5df2\u5173\u8054\u63d0\u62a5\u5355\u636e\uff0c\u65e0\u6cd5\u5220\u9664")})},n.onOk=function(){var e=n.props.query;n.onQuery(m()({},e))},n.sign=function(e){n.props.dispatch({type:"account/sign",payload:{alipayAccount:e}}).then(function(){var e=n.props.signRes;e&&(window.location.href=e)})},n.state={},n}return g()(a,[{key:"componentDidMount",value:function(){var e=this.props.query;this.onQuery(m()({},e))}},{key:"render",value:function(){var e=this,t=this.props,a=t.list,n=t.query,r=t.total,c=t.loading,o=[{title:"\u540d\u79f0",dataIndex:"name",render:function(e,t){return O.a.createElement("span",null,O.a.createElement("span",{style:{marginRight:"8px"}},t.name),t.isDefault&&O.a.createElement(p["a"],{color:"blue"},"\u9ed8\u8ba4"),0===t.status&&O.a.createElement(p["a"],{color:"red"},"\u5df2\u505c\u7528"))},width:220},{title:"\u8d26\u6237\u7c7b\u578b",dataIndex:"type",render:function(e,t){return O.a.createElement("span",null,Object(D["z"])(t.type,D["a"]))},width:100},{title:"\u7b7e\u7ea6\u72b6\u6001",dataIndex:"signStatus",render:function(e,t){return O.a.createElement(O.a.Fragment,null,1===t.type?O.a.createElement("span",null,Object(D["z"])(t.signStatus,D["K"])):"-")},width:100},{title:"\u5907\u6ce8",dataIndex:"note",width:160,render:function(e){return O.a.createElement("span",null,O.a.createElement(u["a"],{placement:"topLeft",title:e||""},O.a.createElement("span",{className:"eslips-2"},e)))}},{title:"\u64cd\u4f5c",dataIndex:"ope",render:function(t,a){return O.a.createElement("span",{style:{width:"120px",display:"inline-block",textAlign:"left"}},O.a.createElement("span",{className:"deleteColor",onClick:function(){return e.handleVisibleChange(a.id)}},"\u5220\u9664"),O.a.createElement(s["a"],{type:"vertical"}),O.a.createElement($,{title:"edit",record:a,onOk:function(){return e.onOk()}},O.a.createElement("a",null,"\u7f16\u8f91")),1===a.type&&!a.signStatus&&O.a.createElement(O.a.Fragment,null,O.a.createElement(s["a"],{type:"vertical"}),O.a.createElement("a",{onClick:function(){return e.sign(a.account)}},"\u7b7e\u7ea6")))},width:"120px",className:"fixCenter",fix:"right"}];return O.a.createElement("div",null,O.a.createElement(V["a"],{title:"\u516c\u53f8\u4ed8\u6b3e\u8d26\u6237\u8bbe\u7f6e"}),O.a.createElement("div",{className:"content-dt"},O.a.createElement("div",{className:"cnt-header"},O.a.createElement("div",{className:"head_lf"},O.a.createElement($,{onOk:this.onOk,title:"add"},O.a.createElement(i["a"],{type:"primary"},"\u65b0\u589e\u4ed8\u6b3e\u8d26\u6237")))),O.a.createElement(l["a"],{columns:o,dataSource:a,loading:c,scroll:{x:"640px"},pagination:{current:n.pageNo,total:r,onChange:function(t){e.onQuery({pageNo:t,pageSize:n.pageSize})},size:"small",showTotal:function(){return"\u5171".concat(r,"\u6761\u6570\u636e")},showSizeChanger:!0,showQuickJumper:!0,onShowSizeChange:function(t,a){e.onQuery({pageNo:t,pageSize:a})}}})))}}]),a}(x["Component"]),U=W))||U);t["default"]=ne}}]);