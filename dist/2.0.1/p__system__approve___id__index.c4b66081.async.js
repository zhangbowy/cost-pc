(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[76],{"0CuA":function(e,t,a){"use strict";a.r(t);a("g9YV");var n,r,o,l,i=a("wCAj"),c=(a("+L6B"),a("2/Rp")),s=a("jehZ"),p=a.n(s),u=(a("/zsF"),a("PArb")),d=(a("P2fV"),a("NJEC")),m=a("p0pE"),f=a.n(m),h=(a("miYZ"),a("tsqr")),y=a("2Taf"),v=a.n(y),b=a("vZ4D"),g=a.n(b),k=a("MhPg"),E=a.n(k),D=a("l4Ni"),R=a.n(D),C=a("ujKo"),S=a.n(C),V=a("q1tI"),I=a.n(V),w=(a("17x9"),a("wd/R")),N=a.n(w),U=a("/MKj"),x=a("rP2T"),O=(a("2qtc"),a("kLXV")),P=a("eHn4"),A=a.n(P),Y=(a("y8nQ"),a("Vl3Y")),j=(a("nRaC"),a("5RzL")),L=a("2g+w"),q=a("svdq"),M=a("ydnR"),Q=a("WYR1");function T(e){var t=F();return function(){var a,n=S()(e);if(t){var r=S()(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return R()(this,a)}}function F(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var z,H,J,K=j["a"].SHOW_CHILD,Z=(n=Y["a"].create(),r=Object(U["c"])(function(e){var t=e.global,a=e.loading,n=e.approveRole;return{costCategoryList:t.costCategoryList,loading:a.effects["approveRole/add"]||a.effects["approveRole/edit"]||!1,details:n.details}}),n(o=r((l=function(e){E()(a,e);var t=T(a);function a(){var e;v()(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return e=t.call.apply(t,[this].concat(r)),e.state={visible:e.props.visible,category:[],userVo:[],makeUser:[],bearUser:[],makeDept:[],bearDept:[]},e.onShow=function(){var t=e.props,a=t.title,n=t.detail;e.props.dispatch({type:"global/costList",payload:{}}).then(function(){"edit"===a&&e.props.dispatch({type:"approveRole/detail",payload:{id:n.id}}).then(function(){var t=e.props.details;console.log(t.userVo),e.setState({userVo:t.userVo?[t.userVo].map(function(e){return f()({},e,{userName:e.name})}):[],makeUser:t.makeUser?t.makeUser.map(function(e){return f()({},e,{userName:e.name})}):[],bearUser:t.bearUser?t.bearUser.map(function(e){return f()({},e,{userName:e.name})}):[],bearDept:t.bearDept?t.bearDept.map(function(e){return f()({},e,{deptId:"".concat(e.deptId)})}):[],makeDept:t.makeDept?t.makeDept.map(function(e){return f()({},e,{deptId:"".concat(e.deptId)})}):[],category:t.categoryVos?t.categoryVos.map(function(e){return{label:e.costName,value:e.id}}):[],visible:!0})}),e.setState({visible:!0})})},e.onCancel=function(){e.props.form.resetFields(),e.setState({visible:!1,category:[],userVo:[],makeUser:[],bearUser:[],makeDept:[],bearDept:[]})},e.handleOk=function(){var t=e.props,a=t.form,n=t.dispatch,r=t.loading,o=t.title,l=t.id,i=t.onOk,c=t.detail,s=e.state,p=s.userVo,u=s.makeUser,d=s.bearUser,m=s.makeDept,f=s.bearDept;r||a.validateFieldsAndScroll(function(t,a){t||n({type:"approveRole/".concat(o),payload:{categoryVos:a.categoryVos.map(function(e){return{costName:e.label,id:e.value}}),userVo:p[0],makeUser:u,bearUser:d,makeDept:m,bearDept:f,approveRoleId:l,id:c&&c.id?c.id:""}}).then(function(){e.onCancel(),i()})})},e.selectPle=function(t,a){var n;"userVo"!==a?e.setState((n={},A()(n,"".concat(a,"User"),t.users),A()(n,"".concat(a,"Dept"),t.depts),n)):e.setState({userVo:t.users})},e.onChangeTree=function(t,a,n){console.log(n),console.log(t,"value"),e.setState({category:t})},e}return g()(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.children,n=t.form.getFieldDecorator,r=t.costCategoryList,o=t.loading,l=t.title,i=Object(L["a"])({rootId:0,pId:"parentId",name:"costName",tName:"title",tId:"value",other:"type"},r),s=this.state,u=s.visible,d=s.category,m=s.userVo,f=s.makeUser,h=s.bearUser,y=s.makeDept,v=s.bearDept;return I.a.createElement("span",null,I.a.createElement("span",{onClick:this.onShow},a),I.a.createElement(O["a"],{visible:u,title:"".concat(M["u"][l],"\u4eba\u5458"),onCancel:this.onCancel,bodyStyle:{height:"470px",overflowY:"scroll"},footer:[I.a.createElement(c["a"],{key:"cancel",onClick:this.onCancel},"\u53d6\u6d88"),I.a.createElement(c["a"],{key:"save",onClick:this.handleOk,type:"primary",disabled:o},"\u4fdd\u5b58")]},I.a.createElement(Y["a"],null,I.a.createElement(Y["a"].Item,p()({label:"\u4eba\u5458"},M["x"]),I.a.createElement(q["a"],{users:m||[],placeholder:"\u8bf7\u9009\u62e9",onSelectPeople:function(t){return e.selectPle(t,"userVo")},invalid:!1,disabled:!1,flag:"users",multiple:!1})),I.a.createElement("div",{className:"m-b-16"},I.a.createElement(Q["a"],{name:"\u7ba1\u7406\u8303\u56f4",fontSize:"fs-14"})),I.a.createElement(Y["a"].Item,p()({label:"\u627f\u62c5\u4eba/\u90e8\u95e8"},M["x"]),I.a.createElement(q["a"],{users:h||[],depts:v||[],placeholder:"\u8bf7\u9009\u62e9",onSelectPeople:function(t){return e.selectPle(t,"bear")},invalid:!1,disabled:!1,flag:"useApep",multiple:!0})),I.a.createElement(Y["a"].Item,p()({label:"\u63d0\u4ea4\u4eba/\u90e8\u95e8"},M["x"]),I.a.createElement(q["a"],{users:f||[],depts:y||[],placeholder:"\u8bf7\u9009\u62e9",onSelectPeople:function(t){return e.selectPle(t,"make")},invalid:!1,disabled:!1,flag:"useApep",multiple:!0})),I.a.createElement(Y["a"].Item,p()({label:"\u652f\u51fa\u7c7b\u522b"},M["x"]),n("categoryVos",{initialValue:d})(I.a.createElement(j["a"],{onChange:function(t,a,n){return e.onChangeTree(t,a,n)},treeData:i,labelInValue:!0,treeCheckable:!0,style:{width:"100%"},showCheckedStrategy:K,dropdownStyle:{height:"300px"}}))))))}}]),a}(V["Component"]),o=l))||o)||o),W=Z;function B(e){var t=X();return function(){var a,n=S()(e);if(t){var r=S()(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return R()(this,a)}}function X(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var _=(z=Object(U["c"])(function(e){var t=e.approveRole,a=e.loading;return{list:t.list,detail:t.detail,loading:a.effects["approveRole/list"]||!1}}),z((J=function(e){E()(a,e);var t=B(a);function a(){var e;v()(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return e=t.call.apply(t,[this].concat(r)),e.onQuery=function(t){var a=e.props.match.params.id;Object.assign(t,{id:a}),e.props.dispatch({type:"approveRole/list",payload:t})},e.handleOk=function(){e.onQuery({})},e.onDelete=function(t){var a=e.props,n=a.query,r=a.dispatch;r({type:"approveRole/del",payload:{id:t}}).then(function(){h["a"].success("\u5220\u9664\u6210\u529f"),e.onQuery(f()({},n))})},e}return g()(a,[{key:"componentDidMount",value:function(){var e=this.props.match.params.id;this.props.dispatch({type:"approveRole/details",payload:{id:e}}),this.onQuery({})}},{key:"render",value:function(){var e=this,t=this.props.match.params.id,a=this.props.detail,n=[{title:"\u4eba\u5458",dataIndex:"userName"},{title:"\u5206\u914d\u4eba",dataIndex:"createName"},{title:"\u5206\u914d\u65f6\u95f4",dataIndex:"createTime",render:function(e){return I.a.createElement("span",null,e&&N()(e).format("YYYY-MM-DD"))}},{title:"\u64cd\u4f5c",dataIndex:"ope",width:"190px",className:"fixCenter",render:function(a,n){return I.a.createElement("span",null,!n.isSupperAdmin&&I.a.createElement(d["a"],{title:"\u786e\u8ba4\u5220\u9664\u8be5\u4eba\u5458\u5417?",onConfirm:function(){return e.onDelete(n.id)}},I.a.createElement("span",{className:"deleteColor"},"\u5220\u9664")),!n.isSupperAdmin&&I.a.createElement(u["a"],{type:"vertical"}),I.a.createElement(W,{title:"edit",isSupperAdmin:n.isSupperAdmin,onOk:e.handleOk,detail:n,id:t},I.a.createElement("a",null,"\u7f16\u8f91")))}}],r=this.props,o=r.list,l=r.loading;return I.a.createElement("div",null,I.a.createElement(x["a"],p()({content:{roleName:a.approveRoleName,note:a.note},sub:!0,title:"\u5ba1\u6279\u89d2\u8272"},this.props)),I.a.createElement("div",{className:"content-dt"},I.a.createElement(W,{detail:{},title:"add",onOk:this.handleOk,id:t},I.a.createElement(c["a"],{type:"primary",className:"m-b-16"},"\u65b0\u589e\u4eba\u5458")),I.a.createElement(i["a"],{rowKey:"id",columns:n,dataSource:o,loading:l,pagination:!1})))}}]),a}(V["Component"]),H=J))||H);t["default"]=_}}]);