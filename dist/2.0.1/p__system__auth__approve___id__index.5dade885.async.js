(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[82],{"6TIU":function(e,t,a){"use strict";a.r(t);a("g9YV");var n,r,o,l,i=a("wCAj"),c=(a("+L6B"),a("2/Rp")),s=(a("/zsF"),a("PArb")),p=(a("P2fV"),a("NJEC")),u=a("p0pE"),d=a.n(u),m=(a("miYZ"),a("tsqr")),f=a("2Taf"),h=a.n(f),y=a("vZ4D"),v=a.n(y),g=a("MhPg"),b=a.n(g),k=a("l4Ni"),E=a.n(k),S=a("ujKo"),D=a.n(S),R=a("q1tI"),C=a.n(R),w=(a("17x9"),a("wd/R")),N=a.n(w),V=a("/MKj"),I=a("KtMI"),U=(a("2qtc"),a("kLXV")),x=a("jehZ"),O=a.n(x),P=a("eHn4"),A=a.n(P),z=(a("y8nQ"),a("Vl3Y")),Y=(a("nRaC"),a("5RzL")),j=a("2g+w"),q=a("svdq"),L=a("ydnR"),Q=a("WYR1");function T(e){var t=M();return function(){var a,n=D()(e);if(t){var r=D()(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return E()(this,a)}}function M(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var K,F,J,Z=Y["a"].SHOW_PARENT,H=(n=z["a"].create(),r=Object(V["c"])(function(e){var t=e.global,a=e.loading,n=e.approveRole;return{costCategoryList:t.costCategoryList,loading:a.effects["approveRole/add"]||a.effects["approveRole/edit"]||!1,details:n.details}}),n(o=r((l=function(e){b()(a,e);var t=T(a);function a(){var e;h()(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return e=t.call.apply(t,[this].concat(r)),e.state={visible:e.props.visible,category:[],userVo:[],makeUser:[],bearUser:[],makeDept:[],bearDept:[]},e.onShow=function(){var t=e.props,a=t.title,n=t.detail;e.props.dispatch({type:"global/costList",payload:{}}).then(function(){"edit"===a&&e.props.dispatch({type:"approveRole/detail",payload:{id:n.id}}).then(function(){var t=e.props.details;console.log(t.userVo),e.setState({userVo:t.userVo?[t.userVo].map(function(e){return d()({},e,{userName:e.name})}):[],makeUser:t.makeUser?t.makeUser.map(function(e){return d()({},e,{userName:e.name})}):[],bearUser:t.bearUser?t.bearUser.map(function(e){return d()({},e,{userName:e.name})}):[],bearDept:t.bearDept?t.bearDept.map(function(e){return d()({},e,{deptId:"".concat(e.deptId)})}):[],makeDept:t.makeDept?t.makeDept.map(function(e){return d()({},e,{deptId:"".concat(e.deptId)})}):[],category:t.categoryVos?t.categoryVos.map(function(e){return{label:e.costName,value:e.id}}):[],visible:!0})}),e.setState({visible:!0})})},e.onCancel=function(){e.props.form.resetFields(),e.setState({visible:!1,category:[],userVo:[],makeUser:[],bearUser:[],makeDept:[],bearDept:[]})},e.handleOk=function(){var t=e.props,a=t.form,n=t.dispatch,r=t.loading,o=t.title,l=t.id,i=t.onOk,c=t.detail,s=t.costCategoryList,p=e.state,u=p.userVo,d=p.makeUser,m=p.bearUser,f=p.makeDept,h=p.bearDept;r||a.validateFieldsAndScroll(function(t,a){if(!t){var r=s.filter(function(e){return!e.type}),p=r&&r.length?r.map(function(e){return e.id}):[];n({type:"approveRole/".concat(o),payload:{categoryVos:a.categoryVos.map(function(e){return{costName:e.label,id:e.value,isGroup:p.includes(e.value)}}),userVo:u[0],makeUser:d,bearUser:m,makeDept:f,bearDept:h,approveRoleId:l,id:c&&c.id?c.id:""}}).then(function(){e.onCancel(),i()})}})},e.selectPle=function(t,a){var n;"userVo"!==a?e.setState((n={},A()(n,"".concat(a,"User"),t.users),A()(n,"".concat(a,"Dept"),t.depts),n)):e.setState({userVo:t.users})},e.onChangeTree=function(t,a,n){console.log(n),console.log(t),e.setState({category:t})},e}return v()(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.children,n=t.form.getFieldDecorator,r=t.costCategoryList,o=t.loading,l=t.title,i=Object(j["a"])({rootId:0,pId:"parentId",name:"costName",tName:"title",tId:"value",otherKeys:["type"]},r),s=this.state,p=s.visible,u=s.category,d=s.userVo,m=s.makeUser,f=s.bearUser,h=s.makeDept,y=s.bearDept;return C.a.createElement("span",null,C.a.createElement("span",{onClick:this.onShow},a),C.a.createElement(U["a"],{visible:p,title:"".concat(L["u"][l],"\u4eba\u5458"),onCancel:this.onCancel,bodyStyle:{overflowY:"scroll"},footer:[C.a.createElement(c["a"],{key:"cancel",onClick:this.onCancel},"\u53d6\u6d88"),C.a.createElement(c["a"],{key:"save",onClick:this.handleOk,type:"primary",disabled:o},"\u4fdd\u5b58")]},C.a.createElement(z["a"],null,C.a.createElement(z["a"].Item,O()({label:"\u4eba\u5458"},L["x"]),C.a.createElement(q["a"],{users:d||[],placeholder:"\u8bf7\u9009\u62e9",onSelectPeople:function(t){return e.selectPle(t,"userVo")},invalid:!1,disabled:!1,flag:"users",multiple:!1})),C.a.createElement("div",{className:"m-b-16"},C.a.createElement(Q["a"],{name:"\u7ba1\u7406\u8303\u56f4",fontSize:"fs-14"})),C.a.createElement(z["a"].Item,O()({label:"\u627f\u62c5\u4eba/\u90e8\u95e8"},L["x"]),C.a.createElement(q["a"],{users:f||[],depts:y||[],placeholder:"\u8bf7\u9009\u62e9",onSelectPeople:function(t){return e.selectPle(t,"bear")},invalid:!1,disabled:!1,flag:"useApep",multiple:!0})),C.a.createElement(z["a"].Item,O()({label:"\u63d0\u4ea4\u4eba/\u90e8\u95e8"},L["x"]),C.a.createElement(q["a"],{users:m||[],depts:h||[],placeholder:"\u8bf7\u9009\u62e9",onSelectPeople:function(t){return e.selectPle(t,"make")},invalid:!1,disabled:!1,flag:"useApep",multiple:!0})),C.a.createElement(z["a"].Item,O()({label:"\u652f\u51fa\u7c7b\u522b"},L["x"]),n("categoryVos",{initialValue:u})(C.a.createElement(Y["a"],{onChange:function(t,a,n){return e.onChangeTree(t,a,n)},treeData:i,labelInValue:!0,treeCheckable:!0,style:{width:"100%"},showCheckedStrategy:Z,dropdownStyle:{height:"300px"}}))))))}}]),a}(R["Component"]),o=l))||o)||o),W=H;function B(e){var t=G();return function(){var a,n=D()(e);if(t){var r=D()(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return E()(this,a)}}function G(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var X=(K=Object(V["c"])(function(e){var t=e.approveRole,a=e.loading;return{list:t.list,detail:t.detail,query:t.query,total:t.total,loading:a.effects["approveRole/list"]||!1}}),K((J=function(e){b()(a,e);var t=B(a);function a(){var e;h()(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return e=t.call.apply(t,[this].concat(r)),e.onQuery=function(t){var a=e.props.match.params.id;Object.assign(t,{id:a}),e.props.dispatch({type:"approveRole/list",payload:t})},e.handleOk=function(){e.onQuery({pageNo:1,pageSize:10})},e.onDelete=function(t){var a=e.props,n=a.query,r=a.dispatch;r({type:"approveRole/del",payload:{id:t}}).then(function(){m["a"].success("\u5220\u9664\u6210\u529f"),e.onQuery(d()({},n))})},e}return v()(a,[{key:"componentDidMount",value:function(){var e=this.props.match.params.id;this.props.dispatch({type:"approveRole/details",payload:{id:e}}),this.onQuery({pageNo:1,pageSize:10})}},{key:"render",value:function(){var e=this,t=this.props.match.params.id,a=this.props,n=a.detail,r=a.query,o=a.total,l=[{title:"\u4eba\u5458",dataIndex:"userName"},{title:"\u5206\u914d\u4eba",dataIndex:"createName"},{title:"\u5206\u914d\u65f6\u95f4",dataIndex:"createTime",render:function(e){return C.a.createElement("span",null,e&&N()(e).format("YYYY-MM-DD"))}},{title:"\u64cd\u4f5c",dataIndex:"ope",width:"190px",className:"fixCenter",render:function(a,n){return C.a.createElement("span",null,!n.isSupperAdmin&&C.a.createElement(p["a"],{title:"\u786e\u8ba4\u5220\u9664\u8be5\u4eba\u5458\u5417?",onConfirm:function(){return e.onDelete(n.id)}},C.a.createElement("span",{className:"deleteColor"},"\u5220\u9664")),!n.isSupperAdmin&&C.a.createElement(s["a"],{type:"vertical"}),C.a.createElement(W,{title:"edit",isSupperAdmin:n.isSupperAdmin,onOk:e.handleOk,detail:n,id:t},C.a.createElement("a",null,"\u7f16\u8f91")))}}],u=this.props,d=u.list,m=u.loading;return C.a.createElement("div",null,C.a.createElement(I["a"],{title:n.approveRoleName,note:n.note}),C.a.createElement("div",{className:"content-dt"},C.a.createElement(W,{detail:{},title:"add",onOk:this.handleOk,id:t},C.a.createElement(c["a"],{type:"primary",className:"m-b-16"},"\u65b0\u589e\u4eba\u5458")),C.a.createElement(i["a"],{rowKey:"id",columns:l,dataSource:d,loading:m,pagination:{current:r.pageNo,onChange:function(t){e.onQuery({pageNo:t,pageSize:r.pageSize})},size:"small",showTotal:function(){return"\u5171".concat(o,"\u6761\u6570\u636e")},showSizeChanger:!0,showQuickJumper:!0,total:o,onShowSizeChange:function(t,a){e.onQuery({pageNo:t,pageSize:a})}}})))}}]),a}(R["Component"]),F=J))||F);t["default"]=X}}]);