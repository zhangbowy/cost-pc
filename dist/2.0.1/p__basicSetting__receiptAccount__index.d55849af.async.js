(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[28],{bALs:function(e,t,a){"use strict";a.r(t);a("g9YV");var n,r,c,l,o=a("wCAj"),i=(a("+L6B"),a("2/Rp")),u=(a("/zsF"),a("PArb")),s=(a("5Dmo"),a("3S7+")),p=(a("+BJd"),a("mr32")),m=a("p0pE"),d=a.n(m),f=(a("miYZ"),a("tsqr")),h=a("2Taf"),y=a.n(h),g=a("vZ4D"),b=a.n(g),v=a("rlhR"),E=a.n(v),k=a("MhPg"),N=a.n(k),I=a("l4Ni"),C=a.n(I),w=a("ujKo"),A=a.n(w),S=(a("2qtc"),a("kLXV")),O=a("q1tI"),R=a.n(O),x=a("/MKj"),D=a("ydnR"),U=(a("sRBo"),a("kaz8")),V=(a("BoS7"),a("Sdc0")),j=a("jehZ"),q=a.n(j),z=(a("6UJt"),a("DFOY")),P=(a("5NDa"),a("5rEg")),B=(a("y8nQ"),a("Vl3Y")),L=(a("OaEy"),a("2fM7")),Q=a("27j4"),F=a.n(Q),J=a("zX7x"),T=a("2g+w"),Y=a("z0WU");function M(e){var t=K();return function(){var a,n=A()(e);if(t){var r=A()(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return C()(this,a)}}function K(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var Z,G,X,W={type:"\u8d26\u6237\u7c7b\u578b",name:"\u540d\u79f0",account:"\u94f6\u884c\u5361\u53f7",note:"\u5907\u6ce8",defaultStatus:"\u542f\u7528",status:"\u542f\u7528",bankNameBranch:"\u5f00\u6237\u652f\u884c",awAreas:"\u5f00\u6237\u7701\u5e02",imgUrl:"\u6536\u6b3e\u7801"},_=L["a"].Option,H=(n=B["a"].create(),r=Object(x["c"])(function(e){var t=e.loading,a=e.session,n=e.receiptAcc,r=e.costGlobal;return{userInfo:a.userInfo,loading:t.effects["receiptAcc/add"]||t.effects["receiptAcc/edit"]||!1,detail:n.detail,areaCode:r.areaCode}}),n(c=r((l=function(e){N()(a,e);var t=M(a);function a(e){var n;return y()(this,a),n=t.call(this,e),n.onShow=function(){var e=n.props.record,t="0";n.props.dispatch({type:"costGlobal/area",payload:{}}).then(function(){var a=n.props.areaCode;console.log("AddAccount -> onShow -> areaCode",a);var r=Object(T["a"])({rootId:0,pId:"pid",name:"areaName",id:"areaCode",tName:"label",tId:"value"},a);e?(t=e.type,n.props.dispatch({type:"receiptAcc/detail",payload:{id:e.id}}).then(function(){var e=n.props.detail;n.setState({visible:!0,type:t,imgUrl:e.qrUrl?[{imgUrl:e.qrUrl}]:[],data:d()({},e,{awAreas:e.awAreas?e.awAreas.sort(Object(Y["d"])("level")).map(function(e){return e.areaCode}):void 0}),treeList:r})})):n.setState({visible:!0,type:t,treeList:r})})},n.onRest=function(){n.props.form.resetFields(),n.setState({type:"0",imgUrl:[]})},n.handleOk=function(e){e.preventDefault();var t=n.props,a=t.dispatch,r=t.form,c=t.onOk,l=t.detail,o=t.userInfo,i=t.title,u=t.areaCode,s=n.state.imgUrl;r.validateFieldsAndScroll(function(e,t){if(!e){var r=d()({},t,{companyId:o.companyId||"",type:Number(t.type),status:t.status?1:0,awAreas:t.awAreas?t.awAreas.map(function(e){var t=u.filter(function(t){return t.areaCode===e})[0];return d()({},t)}):[]});1!==Number(t.type)&&3!==Number(t.type)||Object.assign(r,{qrUrl:s.length?s[0].imgUrl:""});var p="receiptAcc/add";"edit"===i&&(p="receiptAcc/edit",Object.assign(r,{id:l.id})),a({type:p,payload:r}).then(function(){f["a"].success("\u64cd\u4f5c\u6210\u529f"),n.setState({visible:!1}),n.onRest(),c()})}})},n.onChange=function(e){n.setState({type:e})},n.onChangeImg=function(e){console.log("AddAccount -> val",e),n.setState({imgUrl:e})},n.state={type:"0",visible:!1,imgUrl:[]},n}return b()(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.children,n=t.form.getFieldDecorator,r=t.title,c=t.userInfo,l=this.state,o=l.type,u=l.visible,s=l.loading,p=l.data,m=l.treeList,d=l.imgUrl;return R.a.createElement("span",null,R.a.createElement("span",{onClick:function(){return e.onShow()}},a),R.a.createElement(S["a"],{title:r&&"".concat(D["u"][r],"\u6536\u6b3e\u8d26\u6237"),visible:u,bodyStyle:{height:"400px",overflowY:"scroll"},onCancel:function(){e.onRest(),e.setState({visible:!1})},maskClosable:!1,footer:[R.a.createElement(i["a"],{key:"cancel",onClick:function(){e.onRest(),e.setState({visible:!1})}},"\u53d6\u6d88"),R.a.createElement(i["a"],{key:"submit",type:"primary",onClick:this.handleOk,loading:s},"\u4fdd\u5b58")]},R.a.createElement(B["a"],q()({},D["x"],{className:"formItem"}),R.a.createElement(B["a"].Item,{label:W.type},n("type",{initialValue:Number(o)})(R.a.createElement(L["a"],{onChange:this.onChange},D["a"].map(function(e){return R.a.createElement(_,{key:e.key,value:e.key},e.value)})))),R.a.createElement(B["a"].Item,{label:W.name},n("name",{initialValue:p&&p.name,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u540d\u79f0"},{max:30,message:"\u4e0d\u8d85\u8fc730\u4e2a\u5b57"}]})(R.a.createElement(P["a"],{placeholder:1===Number(o)?"\u8bf7\u8f93\u5165\u4e0e\u8d26\u53f7\u5339\u914d\u7684\u5df2\u5b9e\u540d\u59d3\u540d":"\u8bf7\u8f93\u5165"}))),2!==Number(o)&&4!==Number(o)&&R.a.createElement(B["a"].Item,{label:0===Number(o)?W.account:"\u8d26\u53f7"},n("account",{initialValue:p&&p.account,rules:[{required:2!==Number(o)&&4!==Number(o),message:"\u8bf7\u8f93\u5165".concat(0===Number(o)?W.account:"\u8d26\u53f7")}]})(R.a.createElement(P["a"],{placeholder:"\u8bf7\u8f93\u5165"}))),0===Number(o)&&R.a.createElement(B["a"].Item,{label:"\u5f00\u6237\u884c"},n("bankName",{initialValue:p&&p.bankName})(R.a.createElement(L["a"],{showSearch:!0,placeholder:"\u8bf7\u9009\u62e9",getPopupContainer:function(e){return e.parentNode}},D["i"].map(function(e){return R.a.createElement(_,{key:e},e)})))),0===Number(o)&&R.a.createElement(B["a"].Item,{label:W.awAreas},n("awAreas",{initialValue:p&&p.awAreas||[]})(R.a.createElement(z["a"],{options:m,placeholder:"\u8bf7\u9009\u62e9".concat(W.awAreas),getPopupContainer:function(e){return e.parentNode}}))),0===Number(o)&&R.a.createElement(B["a"].Item,{label:W.bankNameBranch},n("bankNameBranch",{initialValue:p&&p.bankNameBranch})(R.a.createElement(P["a"],{placeholder:"\u8bf7\u8f93\u5165".concat(W.bankNameBranch)}))),R.a.createElement(B["a"].Item,{label:W.note},n("note",{initialValue:p&&p.note})(R.a.createElement(F.a,{placeholder:"\u8bf7\u8f93\u5165"}))),(1===Number(o)||3===Number(o))&&R.a.createElement(B["a"].Item,q()({label:W.imgUrl},D["x"]),n("img",{initialValue:d.length?d:null})(R.a.createElement(J["a"],{onChange:function(t){return e.onChangeImg(t)},imgUrl:d,userInfo:c,maxLen:1}))),R.a.createElement(B["a"].Item,{label:W.status},R.a.createElement("div",null,n("status",{initialValue:!(!p||1!==p.status)||"add"===r,valuePropName:"checked"})(R.a.createElement(V["a"],null))),n("isDefault",{initialValue:p&&p.isDefault,valuePropName:"checked"})(R.a.createElement(U["a"],null,"\u8bbe\u4e3a\u9ed8\u8ba4"))))))}}]),a}(R.a.PureComponent),c=l))||c)||c),$=H;function ee(e){var t=te();return function(){var a,n=A()(e);if(t){var r=A()(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return C()(this,a)}}function te(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var ae=S["a"].confirm,ne=(Z=Object(x["c"])(function(e){var t=e.loading,a=e.receiptAcc,n=e.session;return{loading:t.effects["receiptAcc/list"]||!1,list:a.list,query:a.query,userInfo:n.userInfo,total:a.total,check:a.check}}),Z((X=function(e){N()(a,e);var t=ee(a);function a(e){var n;return y()(this,a),n=t.call(this,e),n.onQuery=function(e){var t=n.props.userInfo;Object.assign(e,{companyId:t.companyId||""}),n.props.dispatch({type:"receiptAcc/list",payload:e})},n.onDelete=function(e){var t=n.props,a=t.userInfo,r=t.query;n.props.dispatch({type:"receiptAcc/del",payload:{id:e,companyId:a.companyId||""}}).then(function(){f["a"].success("\u5220\u9664\u6210\u529f"),n.onQuery(d()({},r))})},n.handleVisibleChange=function(e){var t=E()(n);n.props.dispatch({type:"receiptAcc/delPer",payload:{id:e}}).then(function(){n.props.check?ae({title:"\u8bf7\u786e\u8ba4\u662f\u5426\u5220\u9664?",content:"\u5220\u9664\u4e0d\u80fd\u6062\u590d",okText:"\u786e\u8ba4",okType:"danger",cancelText:"\u53d6\u6d88",onOk:function(){t.onDelete(e)},onCancel:function(){console.log("Cancel")}}):f["a"].error("\u5df2\u5173\u8054\u63d0\u62a5\u5355\u636e\uff0c\u65e0\u6cd5\u5220\u9664")})},n.onOk=function(){var e=n.props.query;n.onQuery(d()({},e))},n.state={},n}return b()(a,[{key:"componentDidMount",value:function(){var e=this.props.query;this.onQuery(d()({},e))}},{key:"render",value:function(){var e=this,t=this.props,a=t.list,n=t.query,r=t.total,c=t.loading,l=[{title:"\u540d\u79f0",dataIndex:"name",render:function(e,t){return R.a.createElement("span",null,R.a.createElement("span",{style:{marginRight:"8px"}},t.name),t.isDefault&&R.a.createElement(p["a"],{color:"blue"},"\u9ed8\u8ba4"),0===t.status&&R.a.createElement(p["a"],{color:"red"},"\u5df2\u505c\u7528"))},width:140},{title:"\u8d26\u6237\u7c7b\u578b",dataIndex:"type",render:function(e,t){return R.a.createElement("span",null,Object(D["z"])(t.type,D["a"]))},width:100},{title:"\u7b7e\u7ea6\u72b6\u6001",dataIndex:"signStatus",render:function(e,t){return R.a.createElement(R.a.Fragment,null,1===t.type?R.a.createElement("span",null,Object(D["z"])(t.signStatus,D["K"])):"-")},width:100},{title:"\u5907\u6ce8",dataIndex:"note",render:function(e){return R.a.createElement("span",null,R.a.createElement(s["a"],{placement:"topLeft",title:e||""},R.a.createElement("span",{className:"eslips-2"},e)))},width:160},{title:"\u64cd\u4f5c",dataIndex:"ope",render:function(t,a){return R.a.createElement("span",null,R.a.createElement("span",{className:"deleteColor",onClick:function(){return e.handleVisibleChange(a.id)}},"\u5220\u9664"),R.a.createElement(u["a"],{type:"vertical"}),R.a.createElement($,{title:"edit",record:a,onOk:function(){return e.onOk()}},R.a.createElement("a",null,"\u7f16\u8f91")))},width:80,className:"fixCenter"}];return R.a.createElement("div",{className:"content-dt"},R.a.createElement("div",{className:"cnt-header"},R.a.createElement("div",{className:"head_lf"},R.a.createElement($,{onOk:this.onOk,title:"add"},R.a.createElement(i["a"],{type:"primary"},"\u65b0\u589e\u6536\u6b3e\u8d26\u6237")))),R.a.createElement(o["a"],{columns:l,dataSource:a,loading:c,pagination:{current:n.pageNo,total:r,onChange:function(t){e.onQuery({pageNo:t,pageSize:n.pageSize})},size:"small",showTotal:function(){return"\u5171".concat(r,"\u6761\u6570\u636e")},showSizeChanger:!0,showQuickJumper:!0,onShowSizeChange:function(t,a){e.onQuery({pageNo:t,pageSize:a})}}}))}}]),a}(O["Component"]),G=X))||G);t["default"]=ne}}]);