(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[73],{Lx1Q:function(e,t,n){e.exports={cnt_foot:"cnt_foot___3RI88",header:"header___2GZ2r",line:"line___2YN0b",btns:"btns___32X4r"}},Pu0p:function(e,t,n){e.exports={app_header:"app_header___1R0Ux",formItem:"formItem___zCmbR"}},wGWR:function(e,t,n){"use strict";n.r(t);n("sRBo");var a=n("kaz8"),r=(n("+L6B"),n("2/Rp")),l=(n("miYZ"),n("tsqr")),o=n("2Taf"),s=n.n(o),c=n("vZ4D"),i=n.n(c),u=n("rlhR"),p=n.n(u),m=n("MhPg"),f=n.n(m),d=n("l4Ni"),h=n.n(d),y=n("ujKo"),v=n.n(y),E=n("q1tI"),b=n.n(E),C=n("/MKj"),I=n("TSYQ"),g=n.n(I),k=n("KtMI"),S=(n("2qtc"),n("kLXV")),N=(n("5Dmo"),n("3S7+")),_=(n("/zsF"),n("PArb")),U=n("p0pE"),R=n.n(U),V=n("qIgq"),A=n.n(V),w=(n("OaEy"),n("2fM7")),O=n("wd/R"),P=n.n(O),j=n("jwRn"),x=n("WYR1"),q=n("ghf+"),D=n("Pu0p"),T=n.n(D);function Y(e){var t=w["a"].Option,n=e.dispatch,a=e.userInfo,o=e.synCompanyTime,s=e.queryUsers,c=Object(E["useState"])(!1),i=A()(c,2),u=i[0],p=i[1],m=Object(E["useState"])([]),f=A()(m,2),d=f[0],h=f[1],y=Object(E["useState"])(),v=A()(y,2),C=v[0],I=v[1],g=Object(E["useState"])(!1),k=A()(g,2),U=k[0],V=k[1],O=Object(E["useState"])(),D=A()(O,2),Y=D[0],z=D[1];function M(e){z(e)}Object(E["useEffect"])(function(){n({type:"peopleSet/getTime",payload:{companyId:a.companyId}}),n({type:"peopleSet/queryUsers",payload:{companyId:a.companyId}})},[]);var L=function(){n({type:"peopleSet/delCompany",payload:{companyId:a.companyId}}).then(function(){l["a"].success("\u6570\u636e\u540c\u6b65\u4e2d\u8bf7\u7a0d\u540e\u67e5\u770b\u4eba\u6570")})},B=function(){p(!0)},F=function(){h([]),I(""),z(""),p(!1)},G=function(){Y?d.length?n({type:"peopleSet/modifyGrant",payload:{userIdExpired:Y,userVO:{userId:d[0].emplId,name:d[0].name}},callback:function(e){e.success?(l["a"].success(e.message),F()):l["a"].error(e.message)}}):l["a"].error("\u8bf7\u9009\u62e9\u4ea4\u63a5\u53d1\u653e\u4eba"):l["a"].error("\u8bf7\u9009\u62e9\u539f\u53d1\u653e\u4eba")},J=function(){return s?s.map(function(e){return b.a.createElement(t,{value:e.id,key:e.id},b.a.createElement(q["a"],{avatar:e.avatar,name:e.name})," ".concat(e.name))}):""},K=function(){return d?d.map(function(e){return b.a.createElement(t,{value:e.emplId,key:e.emplId},b.a.createElement(q["a"],{avatar:e.avatar,name:e.name})," ".concat(e.name))}):b.a.createElement(t,null)},Q=function(e){if(e&&e.length>0){var t=e.map(function(e){return R()({},e,{userId:e.emplId})});h(t),I(e[0].emplId)}},Z=function(){V(!0),Object(j["a"])([],Q,{multiple:!1}),V(!1)};return b.a.createElement("div",null,b.a.createElement(_["a"],{type:"horizontal"}),b.a.createElement("div",{style:{marginTop:"20px"}},b.a.createElement(x["a"],{name:"\u4eba\u5458\u540c\u6b65"},b.a.createElement(N["a"],{title:"\u540c\u6b65\u65f6\u95f4\u53ef\u80fd\u4f1a\u8f83\u957f\uff0c\u8bf7\u7a0d\u540e\u5237\u65b0\u9875\u9762\u67e5\u770b\u540c\u6b65\u7ed3\u679c"},b.a.createElement("i",{className:"iconfont iconIcon-yuangongshouce fs-14 c-black-45 m-l-8"}))),b.a.createElement(r["a"],{className:"m-t-13 m-b-17",onClick:L},"\u540c\u6b65\u9489\u9489\u901a\u8baf\u5f55"),b.a.createElement("p",{className:"fs-14 c-black-45 p-b-15"},"\u4e0a\u6b21\u65f6\u95f4\uff1a",o?P()(Number(o)).format("YYYY-MM-DD hh:mm:ss"):"\u65e0"),b.a.createElement(_["a"],{type:"horizontal"}),b.a.createElement(x["a"],{name:"\u4fee\u6539\u53d1\u653e\u4eba"},b.a.createElement(N["a"],{title:"\u53d1\u653e\u4eba\u5458\u79bb\u804c\u65f6\u53ef\u4fee\u6539\u5df2\u63d0\u4ea4\u5355\u636e\u7684\u53d1\u653e\u4eba"},b.a.createElement("i",{className:"iconfont iconIcon-yuangongshouce fs-14 c-black-45 m-l-8"}))),b.a.createElement(r["a"],{className:"m-t-13 m-b-17",onClick:B},"\u4fee\u6539\u53d1\u653e\u4eba")),b.a.createElement(S["a"],{title:"\u4fee\u6539\u53d1\u653e\u4eba",visible:u,onOk:G,onCancel:F},b.a.createElement("div",{className:T.a.formItem},b.a.createElement("label",null,"\u539f\u53d1\u653e\u4eba\uff1a"),b.a.createElement(w["a"],{showSearch:!0,style:{width:200},placeholder:"\u8bf7\u9009\u62e9",optionFilterProp:"children",size:"large",value:Y,onChange:M},J())),b.a.createElement("div",{className:T.a.formItem},b.a.createElement("label",null,"\u4ea4\u63a5\u53d1\u653e\u4eba\uff1a"),b.a.createElement("div",{style:{display:"inline-block"},onClick:Z},b.a.createElement(w["a"],{style:{width:200},placeholder:"\u8bf7\u9009\u62e9",optionFilterProp:"children",size:"large",value:C,open:U},K())))))}var z=Y,M=n("Lx1Q"),L=n.n(M),B=(n("+BJd"),n("mr32"));function F(e){var t=G();return function(){var n,a=v()(e);if(t){var r=v()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return h()(this,n)}}function G(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var J,K,Q,Z=function(e){f()(n,e);var t=F(n);function n(e){var a;return s()(this,n),a=t.call(this,e),a.onShow=function(){var e=a.props.userVos;a.setState({visible:!0,userVos:e})},a.handleClose=function(e){var t=a.state.userVos,n=t.filter(function(t){return t.userId!==e});console.log(n),a.setState({userVos:n})},a.selectPeople=function(){var e=a.state.userVos,t=p()(a),n=a.props,r=n.payUserCount,l=n.checkAll,o=n.allUserCount;Object(j["a"])(e.map(function(e){return e.userId}),function(n){console.log("\u53d6\u6d88",n);var a=e;n&&n.length>0&&(a=n.map(function(e){return{avatar:e.avatar,userName:e.name,userId:e.emplId}})),t.setState({userVos:a})},{max:l?o:r})},a.onCancel=function(){a.setState({visible:!1})},a.onSave=function(){var e=a.state.userVos;a.onCancel(),a.props.onChangePeo(e)},a.state={visible:e.visible||!1,userVos:[]},a}return i()(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.children,a=t.payUserCount,l=t.checkAll,o=t.allUserCount,s=this.state,c=s.visible,i=s.userVos;return b.a.createElement("span",null,b.a.createElement("span",{onClick:function(){return e.onShow()}},n),b.a.createElement(S["a"],{title:"\u67e5\u770b\u5168\u90e8\u6388\u6743\u4eba\u5458",visible:c,bodyStyle:{height:"334px",overflowY:"scroll"},onCancel:this.onCancel,footer:[b.a.createElement(r["a"],{key:"cancel",onClick:this.onCancel},"\u53d6\u6d88")]},b.a.createElement("div",{className:"m-b-16"},b.a.createElement("span",null,"\u5df2\u6388\u6743",i.length,"\u4eba\uff0c\u8fd8\u53ef\u4ee5\u6388\u6743",l?o-i.length:a-i.length,"\u4eba")),i.map(function(e){return b.a.createElement(B["a"],{className:"m-b-8",key:e.userId},e.userName)})))}}]),n}(E["Component"]),W=Z;function X(e){var t=H();return function(){var n,a=v()(e);if(t){var r=v()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return h()(this,n)}}function H(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var $=(J=Object(C["c"])(function(e){var t=e.peopleSet,n=e.session;return{detail:t.detail,isAll:t.isAll,userVos:t.userVos,allUserCount:t.allUserCount,checkAll:t.checkAll,payUserCount:t.payUserCount,userInfo:n.userInfo,synCompanyTime:t.synCompanyTime,queryUsers:t.queryUsers}}),J((Q=function(e){f()(n,e);var t=X(n);function n(e){var a;return s()(this,n),a=t.call(this,e),a.onInit=function(){a.props.dispatch({type:"peopleSet/detail",payload:{}}).then(function(){var e=a.props,t=e.detail,n=e.isAll,r=e.userVos;t.msg&&l["a"].error(t.msg),a.setState({users:r||[],value:n})})},a.handleChange=function(e){e.target.value?a.props.dispatch({type:"peopleSet/add",payload:{isAll:!0}}).then(function(){a.onInit()}):a.selectPeople()},a.selectPeople=function(){var e=a.state.users,t=a.props,n=t.allUserCount,r=t.checkAll,l=p()(a);Object(j["a"])(e.map(function(e){return e.userId})||[],function(t){var a=e;t.length>0&&(a=t.map(function(e){return{avatar:e.avatar,userName:e.name,userId:e.emplId}}),l.props.dispatch({type:"peopleSet/add",payload:{isAll:!!r&&!(n-a.length>0),userVos:a}}).then(function(){l.onInit()})),l.setState({users:a})})},a.onChange=function(e){var t=a.props.allUserCount,n=a.state.value;a.props.dispatch({type:"peopleSet/add",payload:{isAll:!!n&&!(t-e.length>0),userVos:e}}).then(function(){a.setState({visible:!0}),a.onInit()})},a.onChecked=function(e){a.props.dispatch({type:"peopleSet/add",payload:{isAll:e.target.value}}).then(function(){a.onInit()})},a.state={users:[],value:!1,visible:!1},a}return i()(n,[{key:"componentDidMount",value:function(){this.onInit()}},{key:"render",value:function(){var e=this,t=this.props,n=t.detail,l=t.allUserCount,o=t.checkAll,s=t.isAll,c=t.payUserCount,i=this.state,u=i.value,p=i.users,m=i.visible;return b.a.createElement("div",null,b.a.createElement(k["a"],{title:"\u4eba\u5458\u914d\u7f6e",note:"\u4f60\u53ef\u4ee5\u5728\u8fd9\u91cc\u914d\u7f6e\u53ef\u7528\u946b\u652f\u51fa\u7684\u4eba\u5458"}),b.a.createElement("div",{className:"content-dt",style:{height:"500px"}},b.a.createElement("div",{className:L.a.cnt_foot},b.a.createElement("div",{className:L.a.header},b.a.createElement("div",{className:L.a.line}),b.a.createElement("span",null,"\u6388\u6743\u53ef\u7528\u946b\u652f\u51fa\u7684\u4eba\u5458\uff08\u8d2d\u4e70\u89c4\u683c\uff1a",c,"\u4eba\uff09"))),b.a.createElement("div",{className:g()(L.a.btns,"m-b-16")},b.a.createElement(r["a"],{type:"primary",onClick:function(){return e.selectPeople()},className:"m-r-16"},"\u6dfb\u52a0\u4eba\u5458"),o&&b.a.createElement(a["a"],{checked:u,disabled:s,onChange:function(t){return e.onChecked(t)}},"\u5168\u90e8\u4eba\u5458")),b.a.createElement("span",{className:"c-black-45 fs-14 m-l-10"},"\u5df2\u6388\u6743",p&&p.length>0?"".concat(p[0].userName,"\u3001\u7b49").concat(n.useCount,"\u4eba"):"0\u4eba","\uff0c\u8fd8\u53ef\u4ee5\u6388\u6743",o?l-p.length:c-p.length,"\u4eba\uff0c",b.a.createElement(W,{userVos:p,allUserCount:l,onChangePeo:function(t){return e.onChange(t)},payUserCount:c,visible:m,checkAll:o},b.a.createElement("span",{className:"sub-color",style:{cursor:"pointer"}},"\u67e5\u770b\u5168\u90e8\u6388\u6743\u4eba\u5458>"))),b.a.createElement(z,{dispatch:this.props.dispatch,userInfo:this.props.userInfo,synCompanyTime:this.props.synCompanyTime,queryUsers:this.props.queryUsers})))}}]),n}(E["Component"]),K=Q))||K);t["default"]=$}}]);